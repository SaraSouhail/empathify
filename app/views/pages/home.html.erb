<% if user_signed_in? %>

<div class="video-wrapper today-container today-container today-video-container text-center">
  <h3><i class="fa-solid fa-play" style="color: #F9F871;"></i>  Video of today: </h3>
    <a class="video-link ps-4 mb-3" href="https://www.youtube.com/watch?v=tJsGGsPNakw&t=4s&ab_channel=FightChildAbuse" target="_blank">
       <center><img class="video-thumbnail" alt="Video Thumbnail"></center>
        <span class="play-button">&#9658;</span>
    </a>
    <a class="today-video-link ps-4 text-decoration-none"  id="video-link" href="https://www.youtube.com/watch?v=tJsGGsPNakw&t=4s&ab_channel=FightChildAbuse" target="_blank"></a>
    <hr>
    <h3><i class="fa-brands fa-readme" style="color: #F9F871;"></i> Article of today: </h3>
    <a class="today-video-link ps-4 text-decoration-none" href="https://www.stopbullying.gov/blog/2021/07/29/preventing-cyberbullying-age-smart-phones" target="_blank"> Preventing Cyberbullying in the Age of Smart Phones</a>
    <hr>
    <h3><i class="fa-solid fa-quote-left" style="color: #F9F871;"></i><i class="fa-solid fa-quote-rigght" style="color: #4385f5;"></i>  Advice of today: </h3>
    <strong><p class="advice">"Courage is fire, and bullying is smoke."</p></strong>
</div>
<script>
  // Function to extract video ID from URL
function extractVideoId(url) {
  const match = url.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]+)/);
  return match ? match[1] : null;
}

// Function to get video title
async function getVideoTitle(videoId, apiKey) {
  try {
    const response = await fetch(`https://www.googleapis.com/youtube/v3/videos?id=${videoId}&key=${apiKey}&part=snippet`);
    const data = await response.json();
    if (data.items && data.items.length > 0) {
      return data.items[0].snippet.title;
    } else {
      return null;
    }
  } catch (error) {
    console.error('Error:', error);
    return null;
  }
}

function getYouTubeThumbnail(videoId, quality) {
  const baseUrl = 'https://i.ytimg.com/vi/';
  const endUrl = quality === 'maxres' ? '/maxresdefault.jpg' : '/hqdefault.jpg';
  const thumbnailUrl = baseUrl + videoId + endUrl;
  console.log('Thumbnail URL:', thumbnailUrl);
  const videoThumbnail = document.querySelector('.video-thumbnail');
  console.log('Video Thumbnail:', videoThumbnail);
  videoThumbnail.src = thumbnailUrl;
  return thumbnailUrl;
}

// Example usage
const youtubeUrl = "https://www.youtube.com/watch?v=tJsGGsPNakw&t=4s&ab_channel=FightChildAbuse";
const apiKey = "AIzaSyDSWrwoxw6A84_Z_xfYPyj5WN4miTtutqA";
const quality = 'hqdefault';

const videoId = extractVideoId(youtubeUrl);
if (videoId) {
  getYouTubeThumbnail(videoId, quality)
  getVideoTitle(videoId, apiKey)
    .then(title => {
      if (title) {
        console.log("Video Title:", title);
        document.getElementById("video-link").innerText = title;
      } else {
        console.log("Unable to retrieve video title.");
      }
    })
    .catch(error => console.error('Error:', error));
} else {
  console.log("Invalid YouTube URL.");
}

</script>

<style>
    body {
    background-image: url(<%= asset_path("background_page.png") %>);
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;

  }
</style>

<%else%>


<div class="container main-content d-flex justify-content-center align-items-center class" style="
        margin-top: 43px;">
  <div id="carouselExampleDark" class="carousel carousel-dark slide">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2" aria-label="Slide 3"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active" data-bs-interval="5000">
      <%= image_tag "slide_img1.png", class:"d-block w-100", alt:"..."%>

    </div>
    <div class="carousel-item" data-bs-interval="5000">
      <%= image_tag "slide_img2.png", class:"d-block w-100", alt:"..."%>

    </div>
    <div class="carousel-item">
      <%= image_tag "slide_img3.png", class:"d-block w-100", alt:"..."%>

    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"     style="
    margin-left: -190px"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true" style="
    margin-right: -190px"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
</div>

<section class="portfolio section-padding" id="portfolio">
    <h1 class="title d-flex justify-content-center align-items-center text-align-center">How to Apply</h1>
		<div class="container d-flex justify-content-center align-items-center">
			<div class="row2 d-flex justify-content-center align-items-center" style='margin-top: -55px;'>

        <div class="card06 col-12 col-md-12 col-lg-3">
					<div class="card05 text-light text-center  pb-2">
						<div class="card-body text-dark" style ="height: 268px">

							<h2 class="card-title">Welcome</h2>
							<p class="lead">Just a few steps to join to our family</p><button class="btn   text-dark"></button>
						</div>
					</div>
				</div>

				<div class="card06 col-12 col-md-12 col-lg-3">
					<div class="card05 text-light text-center  pb-2">
						<div class="card-body text-dark" style ="height: 268px">

							<h2 class="card-title"> Sign Up</h2>
							<p class="lead">Fill your informations and add a description about yourself so other users can know more about you</p>
						</div>
					</div>
				</div>
				<div class="card06 col-12 col-md-12 col-lg-3">
					<div class="card05 text-light text-center  pb-2">
						<div class="card-body text-dark" style ="height: 268px">

							<h2 class="card-title">Discover</h2>
							<p class="lead">find a communitty</p><button class="btn text-dark"></button>
						</div>
					</div>
				</div>
        <div class="card06 col-12 col-md-12 col-lg-3">
					<div class="card05 text-light text-center  pb-2">
						<div class="card-body text-dark" style ="height: 268px">

							<h2 class="card-title">Start Chat</h2>
							<p class="lead">Enjoy</p><button class="btn text-dark"></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

<script>
document.addEventListener('DOMContentLoaded', (event) => {
  var myCarousel = document.querySelector('#carouselExampleDark')
  var carousel = new bootstrap.Carousel(myCarousel, {
    interval: 5000,
    ride: 'carousel'
  })
})
</script>
<%end%>
